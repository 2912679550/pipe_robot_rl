<?xml version="1.0"?>
<robot name="test2">
    <!-- 1. Link List (RSP only needs names) -->
    <link name="base_link" />
    <link name="link1" />
    <link name="link2" />
    <link name="link3" />
    <link name="link_dummy" /> <!-- Dummy link for breaking the closed loop -->

    <!-- 2. Joint Definitions (RSP needs accurate parent/child and relative pose) -->
    <joint name="force1" type="revolute">
        <parent link="base_link" />
        <child link="link1" />
        <origin xyz="0 0 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="10.0" velocity="10.0" />
    </joint>

    <joint name="no_force1" type="revolute">
        <parent link="link1" />
        <child link="link2" />
        <!-- Source: SDF no_force1 pose -->
        <origin xyz="0.01109 0.038432 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="10.0" velocity="10.0" />
    </joint>

    <joint name="no_force2" type="revolute">
        <parent link="link2" />
        <child link="link3" />
        <!-- Source: SDF no_force2 pose -->
        <origin xyz="0.071655 0.035574 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="10.0" velocity="10.0" />
    </joint>

    <!-- 3. Closed Loop Handling (Connect to dummy link) -->
    <joint name="no_force3" type="revolute">
        <parent link="link3" />
        <child link="link_dummy" />
        <!-- Source: SDF no_force3 pose -->
        <origin xyz="0.067254 -0.074006 0" rpy="0 0 0" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="10.0" velocity="10.0" />
    </joint>

    <!-- <joint name="no_force3" type="revolute">
        <parent link="link3" />
        <child link="base_link" />
        <axis xyz="0 0 1" />
        <limit lower="-3.14159" upper="3.14159" effort="10.0" velocity="10.0" />
    </joint> -->

    <!-- 4. ROS 2 Control Config (Required for Foxy) -->
    <ros2_control name="test2_ros2_control" type="system">
        <hardware>
            <plugin>gazebo_ros2_control/GazeboSystem</plugin>
        </hardware>
        <joint name="force1">
            <command_interface name="velocity">
                <param name="min">-10</param>
                <param name="max">10</param>
            </command_interface>
            <state_interface name="position" />
            <state_interface name="velocity" />
        </joint>
        <joint name="no_force1">
            <state_interface name="position" />
        </joint>
        <joint name="no_force2">
            <state_interface name="position" />
        </joint>
        <joint name="no_force3">
            <state_interface name="position" />
        </joint>
    </ros2_control>
</robot>
